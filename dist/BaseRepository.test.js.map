{"version":3,"sources":["../dist-esnext/BaseRepository.test.js"],"names":["MONGO_URL","baseRepository","describe","beforeEach","it","entity","id","save","getById","entityDb","newName","query","email","find","limit","i","testLimit","entitiesDb","length","entities","push","getByIds"],"mappings":"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","file":"BaseRepository.test.js","sourcesContent":["import { equal, ok } from 'ptz-assert';\nimport { createRepository } from './index';\nconst MONGO_URL = 'mongodb://localhost:27017/ptz-core-repo';\nvar baseRepository;\n/* tslint:disable:no-string-literal */\ndescribe('BaseRepository', () => {\n    beforeEach(async () => {\n        baseRepository = await createRepository('test-collection', MONGO_URL);\n    });\n    describe('save', () => {\n        it('insert', async () => {\n            const entity = {\n                id: 'testid'\n            };\n            await baseRepository.save(entity);\n            const entityDb = await baseRepository.getById(entity.id);\n            ok(entityDb);\n            equal(entityDb.id, entity.id);\n        });\n        it('update', async () => {\n            const entity = {\n                id: 'testid'\n            };\n            entity['name'] = 'teste';\n            await baseRepository.save(entity);\n            const newName = 'teste2';\n            entity['name'] = newName;\n            await baseRepository.save(entity);\n            const entityDb = await baseRepository.getById(entity.id);\n            ok(entityDb);\n            equal(entityDb.id, entity.id);\n            equal(entityDb['name'], newName);\n        });\n    });\n    describe('find', () => {\n        it('by Email', async () => {\n            const entity = {\n                id: 'testid'\n            };\n            entity['email'] = 'angeloocana@gmail.com';\n            await baseRepository.save(entity);\n            const query = {\n                email: entity['email']\n            };\n            const entityDb = await baseRepository.find(query, { limit: 1 });\n            ok(entityDb[0]);\n            equal(entityDb[0]['email'], entity['email']);\n        });\n        it('limit by 3', async () => {\n            for (let i = 0; i <= 6; i++) {\n                const entity = {\n                    id: 'test' + i\n                };\n                entity['testLimit'] = true;\n                entity['i'] = i;\n                await baseRepository.save(entity);\n            }\n            const query = {\n                testLimit: true\n            };\n            const entitiesDb = await baseRepository.find(query, { limit: 3 });\n            equal(entitiesDb.length, 3);\n        });\n    });\n    describe('getByIds', () => {\n        it('get 3 entities by ids', async () => {\n            const entities = [];\n            for (let i = 0; i <= 6; i++) {\n                const entity = {\n                    id: 'test' + i\n                };\n                entity['i'] = i;\n                entities.push(entity);\n                await baseRepository.save(entity);\n            }\n            const entitiesDb = await baseRepository.getByIds([\n                entities[0].id, entities[1].id, entities[2].id\n            ]);\n            equal(entitiesDb.length, 3);\n        });\n    });\n});\n/* tslint:enable:no-string-literal */\n//# sourceMappingURL=BaseRepository.test.js.map"]}